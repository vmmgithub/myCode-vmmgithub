#!/bin/bash

export DAILY_REFRESH_LOG_DIR="/storage/log"
export DAILY_REFRESH_LOG_FILE="${DAILY_REFRESH_LOG_DIR}/Automated_SQLDB_Update_${DATE_SUFFIX}*.log"
export EX_HOME="/data/workspace/bluecoat/extracts/bookings"
export TMP_EX_HOME="/tmp/bluecoat"
export TMP_DIR="/tmp/${TENANT}/tmp"
export SCRIPT_HOME="/data/software/Implementations/data_services/bookings/tenants/bluecoat/sh"
export DAT_FILE_DIR="/data/workspace/bluecoat/clientdata/Bluecoat/${DATE_SUFFIX}_Bluecoat"
export SQL_TMP_DIR="$DAT_FILE_DIR"
export SQL_HOME="/data/software/Implementations/data_services/bookings/tenants/bluecoat/sql"

export LOG_SQL_SH="${SCRIPT_HOME}/bookings_log_update.sh"

export TENANT_STORED_PROC="bluecoat_call_stored_proc.sql"
export TENANT_EXTRACT_PROC="bluecoat_create_scrub_files.sql"
export TENANT_COMPLETE_PROC="bluecoat_call_complete_proc.sql"
export TENANT_CREATE_SCRUB_SH="bluecoat_create_scrub_files.sh"

export BASE_DIR="/data/workspace/bluecoat/clientdata"
export CLIENT="Bluecoat"

# WEEKLY_DAY is the day of the week for files that get sent weekly
export WEEKLY_DAY=""

# Prefix names of files sent daily from tenant to SREV
export DAILY_FILES=(
"BLUECOAT_DISCOVERER_RENEWAL"
"BLUECOAT_OSC"
)

# headers of the daily files - to confirm no issues with loads
export BLUECOAT_DISCOVERER_RENEWAL_HEADER="Order Number,Ordered Date,Booked Date,Invoice Number,Invoice Date,Entry Status,Order Type,Order Source,Purchase Order Number,Customer,Customer Number,End User,End User Account Number,Reseller,Reseller Account Number,Line Number,Line Type,Line Status,Price List,Nsp,Dan,Part Number,Item Description,Product Model,Service Type,Service start date,Service end date,Siebel Quote Number,Quote,Quote line,Quote Serial Number,Ordered Quantity,Selling Price,Ext $ Value,License count,Selling Organization,Bill To State,Bill To Country,End User State,End User Country,Region"
export BLUECOAT_OSC_HEADER="Invoice Number,Invoice Date,Order Booked Date,Source Number,Bill To Customer Name,End Customer,Reseller Name,Customer Po Number,Service Type,Item Number,Service Name,Product,Start Date,End Date,Serial Number,Quantity Invoiced,Unit Selling Price,Extended Amount,Bill To State,Bill To Country,Region,End Customer State,End Customer Country,Region"


# Prefix names of files sent weekly from tenant to SREV
export WEEKLY_FILES=()

# File extension of files sent from tenant
export FILE_EXT="csv"

# Number of errors that can happen when retrieving from SFTP site to cause
# script to error. Main source of error is missing files. Can also be connection
# issues.
export ERROR_DAILY_COUNT=2

# SFTP log-in information
export FTP_HOST="74.201.119.36"
export FTP_USER="bluecoatdatatrans"
export HP="1hsefqu"
export FTP_SRC_DIR="/Bluecoat/RenewOnDemand_Bookings_Reconciliation"

# Scrub File Names - no extensions
export CANCELBOOK="01_${CLIENT}_CancelBookings_${DATE_SUFFIX}"
export REVERTOPPTOQUOTE="02_${CLIENT}_RevertOppsToQuote_${DATE_SUFFIX}"
export UPDATEOFF="03_${CLIENT}_UpdateOff_${DATE_SUFFIX}"
export UPDATEOPP="04_${CLIENT}_UpdateOpp_${DATE_SUFFIX}"
export SPLITOPP="05_${CLIENT}_SplitOpp_${DATE_SUFFIX}"
export CLOSEOPP="06_${CLIENT}_CloseOpp_${DATE_SUFFIX}"
export TAGASSET="07_${CLIENT}_TagAsset_${DATE_SUFFIX}"

# scrub file manifest array
export SCRUB_FILES=(
"${CANCELBOOK}_${SS_ENV}.sh"
"${REVERTOPPTOQUOTE}_${SS_ENV}.sh"
"${UPDATEOFF}_${SS_ENV}.sh"
"${UPDATEOPP}_${SS_ENV}.sh"
"${SPLITOPP}_${SS_ENV}.sh"
"${CLOSEOPP}_${SS_ENV}.sh"
"${TAGASSET}_${SS_ENV}.sh"
)

# build associative array rather than simply an array for file names
# the name in square brackets is the name of the scrub command as found in
# the Xtenant_Config table. The name in curly braces is what's found above for
# the respective scrubs output file name.

declare -A SCRUBCREATION=(
[CancelBookings]="${CANCELBOOK}"
[RevertOppsToQuote]="${REVERTOPPTOQUOTE}"
[UpdateOffers]="${UPDATEOFF}"
[UpdateOpps]="${UPDATEOPP}"
[SplitOpps]="${SPLITOPP}"
[CloseOpps]="${CLOSEOPP}"
[TagAssets]="${TAGASSET}"
)


# settings for accessing MySQL
export USERID="dataadmin"
export MYSQLHOST="localhost"
export SCHEMA="bluecoat_bookings"
export IS_LOCAL="LOCAL"
