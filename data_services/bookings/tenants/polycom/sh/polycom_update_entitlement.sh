#!/bin/bash

if [[ ! $1 =~ [2][0][1][3-9]-[0-1][0-9]-[0-3][0-9] ]]
then
	echo "$0 <import date in yyyy-mm-dd format>"
	echo "Example: $0 \"2014-05-21\""
	exit 1
fi

IMPORT_DT="$1"

echo "$(date) Started processing polycom_stg.ENTITLEMENT_DAILY_ACTIVITY data with $IMPORT_DT date"
mysql -s polycom_data -e "
set tmp_table_size=64000000;
set max_heap_table_size=64000000;
set SESSION join_buffer_size=32000000;

/*
** Insert data that already exist in polycom_data.ENTITLEMENT_DAILY_ACTIVITY_EXCEPTION
*/
set autocommit=0;
insert into polycom_data.ENTITLEMENT_DAILY_ACTIVITY_EXCEPTION (
	AGREE_ID,
	AGREE_NAME,
	AGREE_NUM,
	AGREE_PO,
	AGREE_SALES_REGION,
	AGREE_SO,
	NO_OF_ASSET_ENTL_ON_LINE,
	AGREE_LINE_ID,
	AGREE_LINE_NUM,
	AGREE_LINE_PART_LIST,
	AGREE_LINE_PART_NET,
	AGREE_LINE_PART_NET_PER_ASSET,
	AGREE_LINE_QTY,
	AGREE_LINE_CURRENCY,
	AGREE_LINE_SERVICE_PART_NUM,
	AGREE_LINE_SERVICE_PRODUCT,
	ASSET_NUM,
	ASSET_ID,
	ASSET_PO_NUM,
	ASSET_SERIAL_NUM,
	ASSET_SERVICE_REGION,
	ASSET_SHIP_DATE,
	ASSET_SO_NUM,
	ASSET_ADDRESS_1,
	ASSET_ADDRESS_2,
	ASSET_ADDRESS_ID,
	ASSET_CITY,
	ASSET_COUNTRY,
	ASSET_POSTAL,
	ASSET_STATE,
	ASSET_PART_NUM,
	ASSET_PRODUCT,
	ASSET_PRODUCT_DIVISION,
	ASSET_PRODUCT_GROUP,
	ASSET_PRODUCT_ID,
	ASSET_PRODUCT_LINE,
	ENTL_CREATE_DATE,
	ENTL_DELIVERY_TYPE,
	ENTL_END_DATE,
	ENTL_ID,
	ENTL_NAME,
	ENTL_NET_PRICE_PER_ASSET,
	ENTL_NET_PRICE_PER_ASSET_USD,
	ENTL_SERVICE_TYPE,
	ENTL_ST_DATE,
	PREV_AGREE_ID,
	PREV_ENTL_END,
	PREV_ENTL_PO,
	SO_CURRENCY,
	SO_DATE,
	SO_EXT_NET_PRICE,
	SO_EXT_NET_PRICE_USD,
	AGREE_ACCNT_ID,
	AGREE_ACCNT_NAME,
	AGREE_ACCNT_GAN,
	AGREE_ACCNT_ADDRESS_1,
	AGREE_ACCNT_ADDRESS_2,
	AGREE_ACCNT_ADDRESS_ID,
	AGREE_ACCNT_CITY,
	AGREE_ACCNT_COUNTRY,
	AGREE_ACCNT_POSTAL,
	AGREE_ACCNT_STATE,
	AGREE_ACCNT_CONTACT_EMAIL,
	AGREE_ACCNT_CONTACT_NAME,
	AGREE_ACCNT_CONTACT_PHONE,
	AGREE_ACCNT_PGS_CONTACT_EMAIL,
	AGREE_ACCNT_PGS_CONTACT_FIRST,
	AGREE_ACCNT_PGS_CONTACT_ID,
	AGREE_ACCNT_PGS_CONTACT_LAST,
	AGREE_ACCNT_PGS_CONTACT_PHONE,
	AGREE_END_CUST_ID,
	AGREE_END_CUST_NAME,
	AGREE_END_CUST_ADDRESS_1,
	AGREE_END_CUST_ADDRESS_2,
	AGREE_END_CUST_ADDRESS_ID,
	AGREE_END_CUST_CITY,
	AGREE_END_CUST_COUNTRY,
	AGREE_END_CUST_POSTAL,
	AGREE_END_CUST_STATE,
	AGREE_END_CUST_CONTACT_EMAIL,
	AGREE_END_CUST_CONTACT_NAME,
	AGREE_END_CUST_CONTACT_PHONE,
	AGREE_END_CUST_PGS_CONTACT_EMAIL,
	AGREE_END_CUST_PGS_CONTACT_FIRST,
	AGREE_END_CUST_PGS_CONTACT_ID,
	AGREE_END_CUST_PGS_CONTACT_LAST,
	AGREE_END_CUST_PGS_CONTACT_PHONE,
	AGREE_RES_ACCNT_NAME,
	AGREE_RES_ID,
	AGREE_RES_ADDRESS_1,
	AGREE_RES_ADDRESS_2,
	AGREE_RES_ADDRESS_ID,
	AGREE_RES_CITY,
	AGREE_RES_COUNTRY,
	AGREE_RES_POSTAL,
	AGREE_RES_STATE,
	AGREE_RES_CONTACT_EMAIL,
	AGREE_RES_CONTAC_NAME,
	AGREE_RES_CONTACT_PHONE,
	AGREE_RES_PGS_CONTACT_EMAIL,
	AGREE_RES_PGS_CONTACT_FIRST,
	AGREE_RES_PGS_CONTACT_ID,
	AGREE_RES_PGS_CONTACT_LAST,
	AGREE_RES_PGS_CONTACT_PHONE,
	AGREE_SHIP_ACCNT_NAME,
	AGREE_SHIP_ID,
	AGREE_SHIP_ADDRESS_1,
	AGREE_SHIP_ADDRESS_2,
	AGREE_SHIP_ADDRESS_ID,
	AGREE_SHIP_CITY,
	AGREE_SHIP_COUNTRY,
	AGREE_SHIP_POSTAL,
	AGREE_SHIP_STATE,
	AGREE_SHIP_CONTACT_EMAIL,
	AGREE_SHIP_CONTACT_NAME,
	AGREE_SHIP_CONTACT_PHONE,
	AGREE_SHIP_PGS_CONTACT_EMAIL,
	AGREE_SHIP_PGS_CONTACT_FIRST,
	AGREE_SHIP_PGS_CONTACT_ID,
	AGREE_SHIP_PGS_CONTACT_LAST,
	AGREE_SHIP_PGS_CONTACT_PHONE,
	ASSET_OWNER_ACCNT_NAME,
	ASSET_OWNER_ID,
	ASSET_OWNER_ADDRESS_1,
	ASSET_OWNER_ADDRESS_2,
	ASSET_OWNER_ADDRESS_ID,
	ASSET_OWNER_CITY,
	ASSET_OWNER_COUNTRY,
	ASSET_OWNER_POSTAL,
	ASSET_OWNER_STATE,
	ASSET_CONTACT_EMAIL,
	ASSET_CONTACT_FIRST,
	ASSET_CONTACT_ID,
	ASSET_CONTACT_LAST,
	ASSET_CONTACT_PHONE,
	SS_IMPORT_DT,
	EXCEPTION_REASON
)
select
	d.AGREE_ID,
	d.AGREE_NAME,
	d.AGREE_NUM,
	d.AGREE_PO,
	d.AGREE_SALES_REGION,
	d.AGREE_SO,
	d.NO_OF_ASSET_ENTL_ON_LINE,
	d.AGREE_LINE_ID,
	d.AGREE_LINE_NUM,
	d.AGREE_LINE_PART_LIST,
	d.AGREE_LINE_PART_NET,
	d.AGREE_LINE_PART_NET_PER_ASSET,
	d.AGREE_LINE_QTY,
	d.AGREE_LINE_CURRENCY,
	d.AGREE_LINE_SERVICE_PART_NUM,
	d.AGREE_LINE_SERVICE_PRODUCT,
	d.ASSET_NUM,
	d.ASSET_ID,
	d.ASSET_PO_NUM,
	d.ASSET_SERIAL_NUM,
	d.ASSET_SERVICE_REGION,
	d.ASSET_SHIP_DATE,
	d.ASSET_SO_NUM,
	d.ASSET_ADDRESS_1,
	d.ASSET_ADDRESS_2,
	d.ASSET_ADDRESS_ID,
	d.ASSET_CITY,
	d.ASSET_COUNTRY,
	d.ASSET_POSTAL,
	d.ASSET_STATE,
	d.ASSET_PART_NUM,
	d.ASSET_PRODUCT,
	d.ASSET_PRODUCT_DIVISION,
	d.ASSET_PRODUCT_GROUP,
	d.ASSET_PRODUCT_ID,
	d.ASSET_PRODUCT_LINE,
	d.ENTL_CREATE_DATE,
	d.ENTL_DELIVERY_TYPE,
	d.ENTL_END_DATE,
	d.ENTL_ID,
	d.ENTL_NAME,
	d.ENTL_NET_PRICE_PER_ASSET,
	d.ENTL_NET_PRICE_PER_ASSET_USD,
	d.ENTL_SERVICE_TYPE,
	d.ENTL_ST_DATE,
	d.PREV_AGREE_ID,
	d.PREV_ENTL_END,
	d.PREV_ENTL_PO,
	d.SO_CURRENCY,
	d.SO_DATE,
	d.SO_EXT_NET_PRICE,
	d.SO_EXT_NET_PRICE_USD,
	d.AGREE_ACCNT_ID,
	d.AGREE_ACCNT_NAME,
	d.AGREE_ACCNT_GAN,
	d.AGREE_ACCNT_ADDRESS_1,
	d.AGREE_ACCNT_ADDRESS_2,
	d.AGREE_ACCNT_ADDRESS_ID,
	d.AGREE_ACCNT_CITY,
	d.AGREE_ACCNT_COUNTRY,
	d.AGREE_ACCNT_POSTAL,
	d.AGREE_ACCNT_STATE,
	d.AGREE_ACCNT_CONTACT_EMAIL,
	d.AGREE_ACCNT_CONTACT_NAME,
	d.AGREE_ACCNT_CONTACT_PHONE,
	d.AGREE_ACCNT_PGS_CONTACT_EMAIL,
	d.AGREE_ACCNT_PGS_CONTACT_FIRST,
	d.AGREE_ACCNT_PGS_CONTACT_ID,
	d.AGREE_ACCNT_PGS_CONTACT_LAST,
	d.AGREE_ACCNT_PGS_CONTACT_PHONE,
	d.AGREE_END_CUST_ID,
	d.AGREE_END_CUST_NAME,
	d.AGREE_END_CUST_ADDRESS_1,
	d.AGREE_END_CUST_ADDRESS_2,
	d.AGREE_END_CUST_ADDRESS_ID,
	d.AGREE_END_CUST_CITY,
	d.AGREE_END_CUST_COUNTRY,
	d.AGREE_END_CUST_POSTAL,
	d.AGREE_END_CUST_STATE,
	d.AGREE_END_CUST_CONTACT_EMAIL,
	d.AGREE_END_CUST_CONTACT_NAME,
	d.AGREE_END_CUST_CONTACT_PHONE,
	d.AGREE_END_CUST_PGS_CONTACT_EMAIL,
	d.AGREE_END_CUST_PGS_CONTACT_FIRST,
	d.AGREE_END_CUST_PGS_CONTACT_ID,
	d.AGREE_END_CUST_PGS_CONTACT_LAST,
	d.AGREE_END_CUST_PGS_CONTACT_PHONE,
	d.AGREE_RES_ACCNT_NAME,
	d.AGREE_RES_ID,
	d.AGREE_RES_ADDRESS_1,
	d.AGREE_RES_ADDRESS_2,
	d.AGREE_RES_ADDRESS_ID,
	d.AGREE_RES_CITY,
	d.AGREE_RES_COUNTRY,
	d.AGREE_RES_POSTAL,
	d.AGREE_RES_STATE,
	d.AGREE_RES_CONTACT_EMAIL,
	d.AGREE_RES_CONTAC_NAME,
	d.AGREE_RES_CONTACT_PHONE,
	d.AGREE_RES_PGS_CONTACT_EMAIL,
	d.AGREE_RES_PGS_CONTACT_FIRST,
	d.AGREE_RES_PGS_CONTACT_ID,
	d.AGREE_RES_PGS_CONTACT_LAST,
	d.AGREE_RES_PGS_CONTACT_PHONE,
	d.AGREE_SHIP_ACCNT_NAME,
	d.AGREE_SHIP_ID,
	d.AGREE_SHIP_ADDRESS_1,
	d.AGREE_SHIP_ADDRESS_2,
	d.AGREE_SHIP_ADDRESS_ID,
	d.AGREE_SHIP_CITY,
	d.AGREE_SHIP_COUNTRY,
	d.AGREE_SHIP_POSTAL,
	d.AGREE_SHIP_STATE,
	d.AGREE_SHIP_CONTACT_EMAIL,
	d.AGREE_SHIP_CONTACT_NAME,
	d.AGREE_SHIP_CONTACT_PHONE,
	d.AGREE_SHIP_PGS_CONTACT_EMAIL,
	d.AGREE_SHIP_PGS_CONTACT_FIRST,
	d.AGREE_SHIP_PGS_CONTACT_ID,
	d.AGREE_SHIP_PGS_CONTACT_LAST,
	d.AGREE_SHIP_PGS_CONTACT_PHONE,
	d.ASSET_OWNER_ACCNT_NAME,
	d.ASSET_OWNER_ID,
	d.ASSET_OWNER_ADDRESS_1,
	d.ASSET_OWNER_ADDRESS_2,
	d.ASSET_OWNER_ADDRESS_ID,
	d.ASSET_OWNER_CITY,
	d.ASSET_OWNER_COUNTRY,
	d.ASSET_OWNER_POSTAL,
	d.ASSET_OWNER_STATE,
	d.ASSET_CONTACT_EMAIL,
	d.ASSET_CONTACT_FIRST,
	d.ASSET_CONTACT_ID,
	d.ASSET_CONTACT_LAST,
	d.ASSET_CONTACT_PHONE,
	d.SS_IMPORT_DT,
	'Duplicate Record'
FROM
	polycom_stg.ENTITLEMENT_DAILY_ACTIVITY d
	INNER JOIN
	polycom_data.ENTITLEMENT_DAILY_ACTIVITY u
	ON d.ASSET_SERIAL_NUM = u.ASSET_SERIAL_NUM
	AND d.ASSET_ID = u.ASSET_ID
	AND d.PREV_ENTL_END = u.PREV_ENTL_END
	AND d.PREV_AGREE_ID = u.PREV_AGREE_ID
	AND d.SS_IMPORT_DT = '$IMPORT_DT';

select concat('Inserted ', row_count(), ' into polycom_data.ENTITLEMENT_DAILY_ACTIVITY_EXCEPTION rows') from dual;
commit;
/*
** Insert data that does not already exist in polycom_data.ENTITLEMENT_DAILY_ACTIVITY
*/
set autocommit=0;
insert into polycom_data.ENTITLEMENT_DAILY_ACTIVITY (
	AGREE_ID,
	AGREE_NAME,
	AGREE_NUM,
	AGREE_PO,
	AGREE_SALES_REGION,
	AGREE_SO,
	NO_OF_ASSET_ENTL_ON_LINE,
	AGREE_LINE_ID,
	AGREE_LINE_NUM,
	AGREE_LINE_PART_LIST,
	AGREE_LINE_PART_NET,
	AGREE_LINE_PART_NET_PER_ASSET,
	AGREE_LINE_QTY,
	AGREE_LINE_CURRENCY,
	AGREE_LINE_SERVICE_PART_NUM,
	AGREE_LINE_SERVICE_PRODUCT,
	ASSET_NUM,
	ASSET_ID,
	ASSET_PO_NUM,
	ASSET_SERIAL_NUM,
	ASSET_SERVICE_REGION,
	ASSET_SHIP_DATE,
	ASSET_SO_NUM,
	ASSET_ADDRESS_1,
	ASSET_ADDRESS_2,
	ASSET_ADDRESS_ID,
	ASSET_CITY,
	ASSET_COUNTRY,
	ASSET_POSTAL,
	ASSET_STATE,
	ASSET_PART_NUM,
	ASSET_PRODUCT,
	ASSET_PRODUCT_DIVISION,
	ASSET_PRODUCT_GROUP,
	ASSET_PRODUCT_ID,
	ASSET_PRODUCT_LINE,
	ENTL_CREATE_DATE,
	ENTL_DELIVERY_TYPE,
	ENTL_END_DATE,
	ENTL_ID,
	ENTL_NAME,
	ENTL_NET_PRICE_PER_ASSET,
	ENTL_NET_PRICE_PER_ASSET_USD,
	ENTL_SERVICE_TYPE,
	ENTL_ST_DATE,
	PREV_AGREE_ID,
	PREV_ENTL_END,
	PREV_ENTL_PO,
	SO_CURRENCY,
	SO_DATE,
	SO_EXT_NET_PRICE,
	SO_EXT_NET_PRICE_USD,
	AGREE_ACCNT_ID,
	AGREE_ACCNT_NAME,
	AGREE_ACCNT_GAN,
	AGREE_ACCNT_ADDRESS_1,
	AGREE_ACCNT_ADDRESS_2,
	AGREE_ACCNT_ADDRESS_ID,
	AGREE_ACCNT_CITY,
	AGREE_ACCNT_COUNTRY,
	AGREE_ACCNT_POSTAL,
	AGREE_ACCNT_STATE,
	AGREE_ACCNT_CONTACT_EMAIL,
	AGREE_ACCNT_CONTACT_NAME,
	AGREE_ACCNT_CONTACT_PHONE,
	AGREE_ACCNT_PGS_CONTACT_EMAIL,
	AGREE_ACCNT_PGS_CONTACT_FIRST,
	AGREE_ACCNT_PGS_CONTACT_ID,
	AGREE_ACCNT_PGS_CONTACT_LAST,
	AGREE_ACCNT_PGS_CONTACT_PHONE,
	AGREE_END_CUST_ID,
	AGREE_END_CUST_NAME,
	AGREE_END_CUST_ADDRESS_1,
	AGREE_END_CUST_ADDRESS_2,
	AGREE_END_CUST_ADDRESS_ID,
	AGREE_END_CUST_CITY,
	AGREE_END_CUST_COUNTRY,
	AGREE_END_CUST_POSTAL,
	AGREE_END_CUST_STATE,
	AGREE_END_CUST_CONTACT_EMAIL,
	AGREE_END_CUST_CONTACT_NAME,
	AGREE_END_CUST_CONTACT_PHONE,
	AGREE_END_CUST_PGS_CONTACT_EMAIL,
	AGREE_END_CUST_PGS_CONTACT_FIRST,
	AGREE_END_CUST_PGS_CONTACT_ID,
	AGREE_END_CUST_PGS_CONTACT_LAST,
	AGREE_END_CUST_PGS_CONTACT_PHONE,
	AGREE_RES_ACCNT_NAME,
	AGREE_RES_ID,
	AGREE_RES_ADDRESS_1,
	AGREE_RES_ADDRESS_2,
	AGREE_RES_ADDRESS_ID,
	AGREE_RES_CITY,
	AGREE_RES_COUNTRY,
	AGREE_RES_POSTAL,
	AGREE_RES_STATE,
	AGREE_RES_CONTACT_EMAIL,
	AGREE_RES_CONTAC_NAME,
	AGREE_RES_CONTACT_PHONE,
	AGREE_RES_PGS_CONTACT_EMAIL,
	AGREE_RES_PGS_CONTACT_FIRST,
	AGREE_RES_PGS_CONTACT_ID,
	AGREE_RES_PGS_CONTACT_LAST,
	AGREE_RES_PGS_CONTACT_PHONE,
	AGREE_SHIP_ACCNT_NAME,
	AGREE_SHIP_ID,
	AGREE_SHIP_ADDRESS_1,
	AGREE_SHIP_ADDRESS_2,
	AGREE_SHIP_ADDRESS_ID,
	AGREE_SHIP_CITY,
	AGREE_SHIP_COUNTRY,
	AGREE_SHIP_POSTAL,
	AGREE_SHIP_STATE,
	AGREE_SHIP_CONTACT_EMAIL,
	AGREE_SHIP_CONTACT_NAME,
	AGREE_SHIP_CONTACT_PHONE,
	AGREE_SHIP_PGS_CONTACT_EMAIL,
	AGREE_SHIP_PGS_CONTACT_FIRST,
	AGREE_SHIP_PGS_CONTACT_ID,
	AGREE_SHIP_PGS_CONTACT_LAST,
	AGREE_SHIP_PGS_CONTACT_PHONE,
	ASSET_OWNER_ACCNT_NAME,
	ASSET_OWNER_ID,
	ASSET_OWNER_ADDRESS_1,
	ASSET_OWNER_ADDRESS_2,
	ASSET_OWNER_ADDRESS_ID,
	ASSET_OWNER_CITY,
	ASSET_OWNER_COUNTRY,
	ASSET_OWNER_POSTAL,
	ASSET_OWNER_STATE,
	ASSET_CONTACT_EMAIL,
	ASSET_CONTACT_FIRST,
	ASSET_CONTACT_ID,
	ASSET_CONTACT_LAST,
	ASSET_CONTACT_PHONE,
	SS_IMPORT_DT )
select
	d.AGREE_ID,
	d.AGREE_NAME,
	d.AGREE_NUM,
	d.AGREE_PO,
	d.AGREE_SALES_REGION,
	d.AGREE_SO,
	d.NO_OF_ASSET_ENTL_ON_LINE,
	d.AGREE_LINE_ID,
	d.AGREE_LINE_NUM,
	d.AGREE_LINE_PART_LIST,
	d.AGREE_LINE_PART_NET,
	d.AGREE_LINE_PART_NET_PER_ASSET,
	d.AGREE_LINE_QTY,
	d.AGREE_LINE_CURRENCY,
	d.AGREE_LINE_SERVICE_PART_NUM,
	d.AGREE_LINE_SERVICE_PRODUCT,
	d.ASSET_NUM,
	d.ASSET_ID,
	d.ASSET_PO_NUM,
	d.ASSET_SERIAL_NUM,
	d.ASSET_SERVICE_REGION,
	d.ASSET_SHIP_DATE,
	d.ASSET_SO_NUM,
	d.ASSET_ADDRESS_1,
	d.ASSET_ADDRESS_2,
	d.ASSET_ADDRESS_ID,
	d.ASSET_CITY,
	d.ASSET_COUNTRY,
	d.ASSET_POSTAL,
	d.ASSET_STATE,
	d.ASSET_PART_NUM,
	d.ASSET_PRODUCT,
	d.ASSET_PRODUCT_DIVISION,
	d.ASSET_PRODUCT_GROUP,
	d.ASSET_PRODUCT_ID,
	d.ASSET_PRODUCT_LINE,
	d.ENTL_CREATE_DATE,
	d.ENTL_DELIVERY_TYPE,
	d.ENTL_END_DATE,
	d.ENTL_ID,
	d.ENTL_NAME,
	d.ENTL_NET_PRICE_PER_ASSET,
	d.ENTL_NET_PRICE_PER_ASSET_USD,
	d.ENTL_SERVICE_TYPE,
	d.ENTL_ST_DATE,
	d.PREV_AGREE_ID,
	d.PREV_ENTL_END,
	d.PREV_ENTL_PO,
	d.SO_CURRENCY,
	d.SO_DATE,
	d.SO_EXT_NET_PRICE,
	d.SO_EXT_NET_PRICE_USD,
	d.AGREE_ACCNT_ID,
	d.AGREE_ACCNT_NAME,
	d.AGREE_ACCNT_GAN,
	d.AGREE_ACCNT_ADDRESS_1,
	d.AGREE_ACCNT_ADDRESS_2,
	d.AGREE_ACCNT_ADDRESS_ID,
	d.AGREE_ACCNT_CITY,
	d.AGREE_ACCNT_COUNTRY,
	d.AGREE_ACCNT_POSTAL,
	d.AGREE_ACCNT_STATE,
	d.AGREE_ACCNT_CONTACT_EMAIL,
	d.AGREE_ACCNT_CONTACT_NAME,
	d.AGREE_ACCNT_CONTACT_PHONE,
	d.AGREE_ACCNT_PGS_CONTACT_EMAIL,
	d.AGREE_ACCNT_PGS_CONTACT_FIRST,
	d.AGREE_ACCNT_PGS_CONTACT_ID,
	d.AGREE_ACCNT_PGS_CONTACT_LAST,
	d.AGREE_ACCNT_PGS_CONTACT_PHONE,
	d.AGREE_END_CUST_ID,
	d.AGREE_END_CUST_NAME,
	d.AGREE_END_CUST_ADDRESS_1,
	d.AGREE_END_CUST_ADDRESS_2,
	d.AGREE_END_CUST_ADDRESS_ID,
	d.AGREE_END_CUST_CITY,
	d.AGREE_END_CUST_COUNTRY,
	d.AGREE_END_CUST_POSTAL,
	d.AGREE_END_CUST_STATE,
	d.AGREE_END_CUST_CONTACT_EMAIL,
	d.AGREE_END_CUST_CONTACT_NAME,
	d.AGREE_END_CUST_CONTACT_PHONE,
	d.AGREE_END_CUST_PGS_CONTACT_EMAIL,
	d.AGREE_END_CUST_PGS_CONTACT_FIRST,
	d.AGREE_END_CUST_PGS_CONTACT_ID,
	d.AGREE_END_CUST_PGS_CONTACT_LAST,
	d.AGREE_END_CUST_PGS_CONTACT_PHONE,
	d.AGREE_RES_ACCNT_NAME,
	d.AGREE_RES_ID,
	d.AGREE_RES_ADDRESS_1,
	d.AGREE_RES_ADDRESS_2,
	d.AGREE_RES_ADDRESS_ID,
	d.AGREE_RES_CITY,
	d.AGREE_RES_COUNTRY,
	d.AGREE_RES_POSTAL,
	d.AGREE_RES_STATE,
	d.AGREE_RES_CONTACT_EMAIL,
	d.AGREE_RES_CONTAC_NAME,
	d.AGREE_RES_CONTACT_PHONE,
	d.AGREE_RES_PGS_CONTACT_EMAIL,
	d.AGREE_RES_PGS_CONTACT_FIRST,
	d.AGREE_RES_PGS_CONTACT_ID,
	d.AGREE_RES_PGS_CONTACT_LAST,
	d.AGREE_RES_PGS_CONTACT_PHONE,
	d.AGREE_SHIP_ACCNT_NAME,
	d.AGREE_SHIP_ID,
	d.AGREE_SHIP_ADDRESS_1,
	d.AGREE_SHIP_ADDRESS_2,
	d.AGREE_SHIP_ADDRESS_ID,
	d.AGREE_SHIP_CITY,
	d.AGREE_SHIP_COUNTRY,
	d.AGREE_SHIP_POSTAL,
	d.AGREE_SHIP_STATE,
	d.AGREE_SHIP_CONTACT_EMAIL,
	d.AGREE_SHIP_CONTACT_NAME,
	d.AGREE_SHIP_CONTACT_PHONE,
	d.AGREE_SHIP_PGS_CONTACT_EMAIL,
	d.AGREE_SHIP_PGS_CONTACT_FIRST,
	d.AGREE_SHIP_PGS_CONTACT_ID,
	d.AGREE_SHIP_PGS_CONTACT_LAST,
	d.AGREE_SHIP_PGS_CONTACT_PHONE,
	d.ASSET_OWNER_ACCNT_NAME,
	d.ASSET_OWNER_ID,
	d.ASSET_OWNER_ADDRESS_1,
	d.ASSET_OWNER_ADDRESS_2,
	d.ASSET_OWNER_ADDRESS_ID,
	d.ASSET_OWNER_CITY,
	d.ASSET_OWNER_COUNTRY,
	d.ASSET_OWNER_POSTAL,
	d.ASSET_OWNER_STATE,
	d.ASSET_CONTACT_EMAIL,
	d.ASSET_CONTACT_FIRST,
	d.ASSET_CONTACT_ID,
	d.ASSET_CONTACT_LAST,
	d.ASSET_CONTACT_PHONE,
	d.SS_IMPORT_DT
FROM
	polycom_stg.ENTITLEMENT_DAILY_ACTIVITY d
	LEFT OUTER JOIN
	polycom_data.ENTITLEMENT_DAILY_ACTIVITY u
	ON d.ASSET_SERIAL_NUM = u.ASSET_SERIAL_NUM
	AND d.ASSET_ID = u.ASSET_ID
	AND d.PREV_ENTL_END = u.PREV_ENTL_END
	AND d.PREV_AGREE_ID = u.PREV_AGREE_ID
	AND d.SS_IMPORT_DT = '$IMPORT_DT'
WHERE
	u.TMP_ID IS NULL;
select concat('Inserted ', row_count(), ' into polycom_data.ENTITLEMENT_DAILY_ACTIVITY rows') from dual;
commit;
"
echo "$(date) Completed processing polycom_stg.ENTITLEMENT_DAILY_ACTIVITY data with $IMPORT_DT date"
